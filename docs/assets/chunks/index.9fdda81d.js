var z=Object.defineProperty;var M=(o,i,t)=>i in o?z(o,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[i]=t;var P=(o,i,t)=>(M(o,typeof i!="symbol"?i+"":i,t),t),O=(o,i,t)=>{if(!i.has(o))throw TypeError("Cannot "+t)};var s=(o,i,t)=>(O(o,i,"read from private field"),t?t.call(o):i.get(o)),h=(o,i,t)=>{if(i.has(o))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(o):i.set(o,t)},d=(o,i,t,e)=>(O(o,i,"write to private field"),e?e.call(o,t):i.set(o,t),t);var f=(o,i,t)=>(O(o,i,"access private method"),t);import{B as I}from"./wz-base.07e7f891.js";const D=`.pop{border-radius:var(--border-radius-base, 4px);background-color:var(--primary-bg, #fff);filter:drop-shadow(var(--shadow));opacity:0;padding:4px;overflow:hidden}:host([type=custom]) .pop{--pad: 10px}:host([trigger*=contextmenu]) .pop{--pad: 0;transition:0s;width:max-content}:host(:not([type=custom])) .pop:before{content:"";position:fixed;width:16px;height:16px;background-color:inherit;clip-path:path("M 0 8 A 4 4 0 0 0 2.82842712474619 6.82842712474619 L 6.585786437626905 3.0710678118654755 A 2 2 0 0 1 9.414213562373096 3.0710678118654755 L 13.17157287525381 6.82842712474619 A 4 4 0 0 0 16 8 Z")}:host{display:contents;--s: .5;--pad: 12px}.pop{position:fixed;display:flex;flex-direction:column;overflow:visible;visibility:hidden;inset:auto;border:0;opacity:.5;transform:translate(var(--x),var(--y)) scale(var(--s));z-index:10}:host(:is([show],[open])) .pop{transition:var(--transition, .2s);--s: 1;opacity:1;visibility:visible}.pop:after{content:"";position:fixed;inset:calc(var(--pad) * -1);z-index:-1}:host([dir=top]) .pop{transform-origin:bottom;left:calc((var(--left) + var(--right)) * .5px + var(--offset-x, 0) * 1px);top:calc(var(--top) * 1px);--x: -50%;--y: -100%}:host([dir=top]) .pop:before{left:50%;bottom:0;transform:translate(-50%,50%) scaleY(-1)}:host([dir=top]:is([show],[open])) .pop{--y: calc(-100% - var(--pad))}:host([dir=TL]) .pop{transform-origin:left bottom;left:calc(var(--left) * 1px);top:calc(var(--top) * 1px);--x: 0%;--y: -100%}:host([dir=TL]) .pop:before{left:8px;bottom:0;transform:translateY(50%) scaleY(-1)}:host([dir=TL]:is([show],[open])) .pop{--y: calc(-100% - var(--pad))}:host([dir=TR]) .pop{transform-origin:right bottom;left:calc(var(--right) * 1px);top:calc(var(--top) * 1px);--x: -100%;--y: -100%}:host([dir=TR]) .pop:before{right:8px;bottom:0;transform:translateY(50%) scaleY(-1)}:host([dir=TR]:is([show],[open])) .pop{--y: calc(-100% - var(--pad))}:host([dir=LT]) .pop{transform-origin:right top;left:calc(var(--left) * 1px);top:calc(var(--top) * 1px);--x: -100%;--y: 0%}:host([dir=LT]) .pop:before{right:0;top:8px;transform:translate(50%) rotate(90deg)}:host([dir=LT]:is([show],[open])) .pop{--x: calc(-100% - var(--pad))}:host([dir=left]) .pop{transform-origin:right;left:calc(var(--left) * 1px);top:calc((var(--top) + var(--bottom)) * .5px + var(--offset-y, 0) * 1px);--x: -100%;--y: -50%}:host([dir=left]) .pop:before{right:0;top:50%;transform:translate(50%,-50%) rotate(90deg)}:host([dir=left]:is([show],[open])) .pop{--x: calc(-100% - var(--pad))}:host([dir=LB]) .pop{transform-origin:right top;left:calc(var(--left) * 1px);top:calc(var(--bottom) * 1px);--x: -100%;--y: -100%}:host([dir=LB]) .pop:before{right:0;bottom:8px;transform:translate(50%) rotate(90deg)}:host([dir=LB]:is([show],[open])) .pop{--x: calc(-100% - var(--pad))}:host([dir=RT]) .pop{transform-origin:left top;left:calc(var(--right) * 1px);top:calc(var(--top) * 1px);--x: 0%;--y: 0%}:host([dir=RT]) .pop:before{left:0;top:8px;transform:translate(-50%) rotate(-90deg)}:host([dir=RT]:is([show],[open])) .pop{--x: var(--pad)}:host([dir=right]) .pop{transform-origin:left;left:calc(var(--right) * 1px);top:calc((var(--top) + var(--bottom)) * .5px + var(--offset-y, 0) * 1px);--x: 0%;--y: -50%}:host([dir=right]) .pop:before{left:0;top:50%;transform:translate(-50%,-50%) rotate(-90deg)}:host([dir=right]:is([show],[open])) .pop{--x: var(--pad)}:host([dir=RB]) .pop{transform-origin:left bottom;left:calc(var(--right) * 1px);top:calc(var(--bottom) * 1px);--x: 0%;--y: -100%}:host([dir=RB]) .pop:before{left:0;bottom:8px;transform:translate(-50%) rotate(-90deg)}:host([dir=RB]:is([show],[open])) .pop{--x: var(--pad)}:host([dir=bottom]) .pop{transform-origin:top;left:calc((var(--left) + var(--right)) * .5px + var(--offset-x, 0) * 1px);top:calc(var(--bottom) * 1px);--x: -50%;--y: 0%}:host([dir=bottom]) .pop:before{left:50%;top:0;transform:translate(-50%,-50%)}:host([dir=bottom]:is([show],[open])) .pop{--y: var(--pad)}:host([dir=BL]) .pop{transform-origin:left top;left:calc(var(--left) * 1px);top:calc(var(--bottom) * 1px);--x: 0%;--y: 0%}:host([dir=BL]) .pop:before{left:8px;top:0;transform:translateY(-50%)}:host([dir=BL]:is([show],[open])) .pop{--y: var(--pad)}:host([dir=BR]) .pop{transform-origin:right top;left:calc(var(--right) * 1px);top:calc(var(--bottom) * 1px);--x: -100%;--y: 0%}:host([dir=BR]) .pop:before{right:8px;top:0;transform:translateY(-50%)}:host([dir=BR]:is([show],[open])) .pop{--y: var(--pad)}
`;var L,l,v,m,g,B,N,y,E,R,S,T,Y,k,W,C,_,A,H;class X extends I{constructor(){super();h(this,B);h(this,y);h(this,R);h(this,T);h(this,k);h(this,C);h(this,A);h(this,L,void 0);h(this,l,void 0);h(this,v,void 0);h(this,m,void 0);h(this,g,void 0);P(this,"target");P(this,"_documentClickEvent");d(this,L,!1),d(this,v,!1),d(this,m,!1),d(this,g,0),this.adoptedStyle(D),this.shadowRootInit.innerHTML=`
    <div id="pop" class="pop" popover="manual" part="pop">
      <slot></slot>
    </div>
    `,d(this,l,this.shadowRootInit.getElementById("pop")),this._documentClickEvent=[]}static get observedAttributes(){return["open"]}set popHTML(t){s(this,l).innerHTML=t}get isSuportPopOver(){return document.body.popover!==void 0}get dir(){return this.getAttribute("dir")||"BL,TL"}set dir(t){this.setAttribute("dir",t)}get disabled(){return this.getAttribute("disabled")!==null}set disabled(t){this.toggleAttribute("disabled",t)}get auto(){const t=this.getAttribute("auto");return t?t.split(","):[]}set auto(t){this.setAttribute("auto",t)}get open(){return this.getAttribute("open")!==null}get trigger(){return this.getAttribute("trigger")||"hover,focus"}set trigger(t){this.setAttribute("trigger",t)}set open(t){t&&f(this,R,S).call(this),this.toggleAttribute("open",t),this.isSuportPopOver&&s(this,l).togglePopover(t)}set offset(t){const[e,n]=t.split(",");this.style.setProperty("--offset-x",e),this.style.setProperty("--offset-y",n)}get node(){return f(this,B,N).call(this,this.target)}init(t,e){var n;if(t&&t.clientWidth){if(this.target=t,f(this,k,W).call(this,t),Object.keys(e).forEach(r=>{e[r]&&r!=="open"&&(this[r]=e[r])}),e.dir.includes(",")&&(this.auto=e.dir,this.dir=e.dir.split(",")[0]),e.open||(n=e.trigger)!=null&&n.includes("none")){f(this,T,Y).call(this,!!e.open);return}e.trigger.includes("hover")&&(t.addEventListener("mouseenter",()=>{this.disabled||this.open||(d(this,v,!0),s(this,g)&&clearTimeout(s(this,g)),d(this,g,setTimeout(()=>{f(this,y,E).call(this),this.target=t,this.open=!0},200)))}),this.addEventListener("mouseenter",()=>{s(this,v)&&(d(this,m,!0),this.open=!0)}),this.addEventListener("mouseleave",()=>{s(this,m)&&(this.open=!1,d(this,m,!1))}),t.addEventListener("mouseleave",()=>{setTimeout(()=>{s(this,v)&&!s(this,m)&&(d(this,v,!1),this.open=!1),s(this,g)&&clearTimeout(s(this,g))},100)})),e.trigger.includes("focus")&&(t.addEventListener("focus",()=>{this.disabled||(f(this,y,E).call(this),this.target=t,this.open=!0)}),t.addEventListener("blur",()=>{this.open=!1})),e.trigger.includes("click")&&(t.addEventListener("click",r=>{if(r.stopPropagation(),this.disabled||(f(this,y,E).call(this),this.target=t,this.open=!0,this._documentClickEvent.length))return;const c=p=>{const{left:u,top:b,right:w,bottom:a}=s(this,l).getBoundingClientRect();(p.x>w||p.y>a||p.x<u||p.y<b)&&(this.open=!1)};this._documentClickEvent.push(c),document.addEventListener("click",c)}),this.shadowRoot.addEventListener("click",r=>{r.target.closest("[close]")&&(this.open=!1)}))}}render(){if(s(this,L)){this.dispatchEvent(new Event("adopt"));return}d(this,L,!0),this.targetList||(this.targetList=s(this,C,_)),this.targetList.forEach(t=>{f(this,A,H).call(this,t)})}connectedCallback(){this.render()}attributeChangedCallback(t,e,n){t==="open"&&(this.dispatchEvent(new Event("change")),this.open?this.dispatchEvent(new Event("show")):this.dispatchEvent(new Event("hide")))}disconnectedCallback(){this._documentClickEvent.length&&!this.isConnected&&this._documentClickEvent.forEach(t=>{document.removeEventListener("click",t)})}}L=new WeakMap,l=new WeakMap,v=new WeakMap,m=new WeakMap,g=new WeakMap,B=new WeakSet,N=function(t){let e=t;if(!e)return null;for(;e.shadowRoot&&!e.offsetWidth;)e=e.shadowRoot.firstElementChild;return e},y=new WeakSet,E=function(){(!this.isConnected||this.parentNode!==document.body&&!this.isSuportPopOver)&&(document.body.append(this),this.clientWidth)},R=new WeakSet,S=function(){var p;if((p=this.trigger)!=null&&p.includes("contextmenu")||!this.node)return;const{left:t,top:e,right:n,bottom:r,width:c}=this.node.getBoundingClientRect();if(this.style.setProperty("--left",String(t+window.pageXOffset)),this.style.setProperty("--top",String(e+window.pageYOffset)),this.style.setProperty("--right",String(n+window.pageXOffset)),this.style.setProperty("--bottom",String(r+window.pageYOffset)),this.style.setProperty("--width",String(c)),this.auto.length){const u=window.innerWidth,b=window.innerHeight,w={w:s(this,l).offsetWidth+10,h:s(this,l).offsetHeight+10};if(e<w.h){const a=["bottom","BL","BR"].find(x=>this.auto.includes(x));a&&(this.dir=a);return}if(b-r<w.h){const a=["top","TL","TR"].find(x=>this.auto.includes(x));a&&(this.dir=a);return}if(t<w.w){const a=["right","RT","RB"].find(x=>this.auto.includes(x));a&&(this.dir=a);return}if(u-n<w.w){const a=["left","LT","LB"].find(x=>this.auto.includes(x));a&&(this.dir=a);return}}},T=new WeakSet,Y=function(t){const e=new IntersectionObserver(n=>{n.forEach(r=>{const c=r.target,p=r.intersectionRatio;p>0&&p<=1&&(f(this,y,E).call(this),f(this,R,S).call(this),this.open=t,e.unobserve(c))})});e.observe(this.node)},k=new WeakSet,W=function(t){var r,c;if((c=(r=t.parentNode)==null?void 0:r.tagName)!=null&&c.startsWith("wz-"))return;const e={childList:!0,subtree:!0,characterData:!1};new MutationObserver(p=>{p.forEach(u=>{u!=null&&u.removedNodes&&[...u.removedNodes].some(b=>b.contains(t))&&(this==null||this.remove())})}).observe(t.getRootNode(),e)},C=new WeakSet,_=function(){const t=this.getAttribute("target");return t?[...this.getRootNode().querySelectorAll(t)]:[this.previousElementSibling||this.parentNode]},A=new WeakSet,H=function(t){t.clientWidth&&(this.init(t,{dir:this.dir,trigger:this.trigger}),t.pop=this,this.trigger.includes("contextmenu")&&t.addEventListener("contextmenu",e=>{if(e.preventDefault(),this.disabled||((!this.isConnected||this.parentNode!==document.body&&!this.isSuportPopOver)&&(document.body.append(this),this.clientWidth),s(this,l).style.left=e.pageX+"px",s(this,l).style.top=e.pageY+"px",this.open=!0,this._documentClickEvent.length))return;const n=r=>{const{left:c,top:p,right:u,bottom:b}=s(this,l).getBoundingClientRect();(r.x>u||r.y>b||r.x<c||r.y<p)&&(this.open=!1)};this._documentClickEvent.push(n),document.addEventListener("click",n)}))};customElements.get("wz-popover")||(console.log("render"),customElements.define("wz-popover",X));export{X as default};
